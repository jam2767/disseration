---
title: "growth-nsc"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(ggplot2)
library(zoo)
library(scatterplot3d)

#helper functions
#function to find last value of vector
last <- function(x) { return( x[length(x)] ) }

#give sample size on scatterplot for ggplot
give.n <- function(x){
  return(c(y = mean(x), label = length(x)))
}

#color-blind-friendly palettes
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

####make datatable with combined growth-NSC data####
#read NSC data
NSC_data <- read.csv(file = "/Users/josh/Dropbox/Dissertation/CH2_NSC_Empirical/Data/nsc.adult.total.mass.alive.common.csv")

Treering_data <- read.csv("/Users/josh/Dropbox/Dissertation/CH3_Growth_NSC/treering_growth_forgrowthnsc_qc.csv")

colnames(Treering_data)[70] <- "Core_ID14"

#dataset of trees cored for NSC and analyzed for growth with tree rings
growth_nsc_data <- merge(NSC_data, Treering_data, by = "Core_ID14")
```

```{r}
move.avg.growth <- rollapply(growth_nsc_data[,267:287], width = 10, by.column = TRUE, FUN = mean, align = "left")

#include mean growth windows
growth.2014.2010 <- growth_nsc_data[,283:287]
mean.2014.2010 <- rowMeans(growth.2014.2010)
growth_nsc_data.1 <- cbind(growth_nsc_data, mean.2014.2010)
#2014-2010
plot(mean.2014.2010, growth_nsc_data$total.nsc)
summary(lm(mean.2014.2010 ~ growth_nsc_data$total.nsc))

growth.2013.2009 <- growth_nsc_data[,282:286]
mean.2013.2009 <- rowMeans(growth.2013.2009)
growth_nsc_data.2 <- cbind(growth_nsc_data, mean.2013.2009)
#2013-2009
plot(mean.2013.2009, growth_nsc_data$total.nsc)
summary(lm(mean.2013.2009 ~ growth_nsc_data$total.nsc))

growth.2012.2008 <- growth_nsc_data[,281:285]
mean.2012.2008 <- rowMeans(growth.2012.2008)
growth_nsc_data.3 <- cbind(growth_nsc_data, mean.2012.2008)
#2013-2009
plot(mean.2012.2008, growth_nsc_data$total.nsc)
summary(lm(mean.2012.2008 ~ growth_nsc_data$total.nsc))

growth.2010.2001 <- growth_nsc_data[,274:283]
mean.2010.2001 <- rowMeans(growth.2010.2001)
growth_nsc_data.10yr <- cbind(growth_nsc_data, mean.2010.2001)
#2010-2001
plot(growth_nsc_data.10yr$mean.2010.2001, growth_nsc_data.10yr$total.nsc)
summary(lm(growth_nsc_data.10yr$total.nsc ~ growth_nsc_data.10yr$mean.2010.2001))

#PFT differences
growth.nsc.pft.plot <- ggplot(growth_nsc_data.10yr, aes(x = mean.2010.2001, y = total.nsc)) +
  geom_point(alpha = .1) +
  ylim(0,125) +
  #xlim(0,6) +
  ylab(expression(paste("Total NSC mg g"^"-1"))) + xlab(expression(paste("2010-2001 Mean Ring Width mm yr"^"-1"))) +
  geom_smooth(method = "lm") + facet_wrap(~ PFT.y,scales = "free") +
  theme(axis.title.y = element_text(size = 14)) +
  theme(axis.title.x = element_text(size = 14))
  
ggsave(filename = "/Users/josh/Dropbox/Dissertation/CH3_Growth_NSC/Growth_NSC_PFT.png", plot = growth.nsc.pft.plot, dpi = 200, width = 5, height = 3.5, units = "in")

#PFT lm
pft.int.lm <- lm(total.nsc ~ mean.2010.2001 + PFT.y + mean.2010.2001*PFT.y, data = growth_nsc_data.10yr)
summary(pft.int.lm) #significant, very predictive R^2 = .45

#Wood type categories: Hardwood, Conifer
growth_nsc_data.10yr$PFT.y <- as.character(growth_nsc_data.10yr$PFT.y)

  hardwood <- which(growth_nsc_data.10yr$PFT.y == "Early.Hardwood")
  hardwood2 <- which(growth_nsc_data.10yr$PFT.y == "Mid.Hardwood")
  hardwood3 <- which(growth_nsc_data.10yr$PFT.y == "Late.Hardwood")
                      
  conifer <- which(growth_nsc_data.10yr$PFT.y == "Early.Conifer")
  conifer2 <- which(growth_nsc_data.10yr$PFT.y == "Late.Conifer")
  
  growth_nsc_data.10yr$woodgroup <- NA
  growth_nsc_data.10yr$woodgroup[hardwood] <- "Hardwood"
  growth_nsc_data.10yr$woodgroup[hardwood2] <- "Hardwood"
  growth_nsc_data.10yr$woodgroup[hardwood3] <- "Hardwood"
  growth_nsc_data.10yr$woodgroup[conifer] <- "Conifer"
  growth_nsc_data.10yr$woodgroup[conifer2] <- "Conifer"
  
    #Hardwood as reference
growth_nsc_data.10yr$woodgroup <- factor(growth_nsc_data.10yr$woodgroup, 
                                    levels = c("Hardwood","Conifer"),
                                    ordered = TRUE)

  #Set succession
  growth_nsc_data.10yr$succession <- NA
  growth_nsc_data.10yr$succession[hardwood] <- "Early"
  growth_nsc_data.10yr$succession[conifer] <- "Early"
  growth_nsc_data.10yr$succession[hardwood2] <- "Mid"
  growth_nsc_data.10yr$succession[hardwood3] <- "Late"
  growth_nsc_data.10yr$succession[conifer2] <- "Late"
  
  #Early as reference
growth_nsc_data.10yr$succession <- factor(growth_nsc_data.10yr$succession, 
                            levels = c("Early","Mid","Late"),
                            ordered = TRUE)

#Full model with three-way interaction
pft.full.lm <- lm(total.nsc ~ mean.2010.2001 + succession + woodgroup + woodgroup*succession + mean.2010.2001*woodgroup + mean.2010.2001*succession + mean.2010.2001*woodgroup*succession, data = growth_nsc_data.10yr)
anova(pft.full.lm)
summary(pft.full.lm)
#None of the 3-way interactions were significant

#Full model iwth three-way interaction and controlling for
#canopy position and DBH
pft.full.cont.lm <- lm(total.nsc ~ mean.2010.2001 + succession + woodgroup + woodgroup*succession + mean.2010.2001*woodgroup + mean.2010.2001*succession + mean.2010.2001*woodgroup*succession + DBH14.x + CANOPY15, data = growth_nsc_data.10yr)
anova(pft.full.cont.lm)
summary(pft.full.cont.lm)
  
growth.nsc.spp.plot <- ggplot(growth_nsc_data.10yr, aes(x = mean.2010.2001, y = total.nsc)) +
  geom_point(alpha = .1) +
  ylim(0,125) +
  ylab(expression(paste("Total NSC mg g"^"-1"))) + xlab(expression(paste("2010-2001 Mean Ring Width mm yr"^"-1"))) +
  geom_smooth(method = "lm") + facet_wrap(~ GenusSpecies.x) #,scales = "free"
  theme(axis.title.y = element_text(size = 8)) +
  theme(axis.title.x = element_text(size = 8))
  
  ggsave(filename = "/Users/josh/Dropbox/Dissertation/CH3_Growth_NSC/Growth_NSC_Spp.png", plot = growth.nsc.spp.plot, dpi = 200, width = 5, height = 10, units = "in")
  
  #nsc-growth relationship with species
  growth.nsc.spp.lm <- lm(total.nsc ~ mean.2010.2001*GenusSpecies.x, data = growth_nsc_data.10yr)
  summary(growth.nsc.spp.lm)
  
  #### nsc-growth relationships by species
  #### noting significant +, -, 0 because meaningful, 0 because low power
  abba <- which(growth_nsc_data.10yr$GenusSpecies.x == "Abies balsamea")
  lm.abba <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[abba,])
  summary(lm.abba) #marginal
  
  acru <- which(growth_nsc_data.10yr$GenusSpecies.x == "Acer rubrum")
  lm.acru <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[acru,])
  summary(lm.acru)   #significant
  
  # #correct slope for mean growth rate
  #   acru.dat <- growth_nsc_data.10yr[acru,]
  #   acru.mean.correct <- acru.dat$mean.2010.2001 - mean(acru.dat$mean.2010.2001,na.rm = TRUE)
  #   acru.dat$mean.2010.2001.corrected <-NA
  #   acru.dat$mean.2010.2001.corrected <- acru.mean.correct
  #   plot(acru.dat$mean.2010.2001.corrected, acru.dat$total.nsc)
  #   acru.correct.lm <- lm(total.nsc ~ mean.2010.2001.corrected, dat = acru.dat)
  #   summary(acru.correct.lm)
  
  acsa <- which(growth_nsc_data.10yr$GenusSpecies.x == "Acer saccharum")
  lm.acsa <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[acsa,])
  summary(lm.acsa) #marginal
  
  beal <- which(growth_nsc_data.10yr$GenusSpecies.x == "Betula alleghaniensis")
  lm.beal <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[beal,])
  summary(lm.beal)
  
  bele <- which(growth_nsc_data.10yr$GenusSpecies.x == "Betula lenta")
  lm.bele <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[bele,])
  summary(lm.bele)   #significant
  
  bepa <- which(growth_nsc_data.10yr$GenusSpecies.x == "Betula papyrifera")
  lm.bepa <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[bepa,])
  summary(lm.bepa)
  
  cagl <- which(growth_nsc_data.10yr$GenusSpecies.x == "Carya glabra")
  lm.cagl <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[cagl,])
  summary(lm.cagl)
  
  cato <- which(growth_nsc_data.10yr$GenusSpecies.x == "Carya tomentosa")
  lm.cato <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[cato,])
  summary(lm.cato)
  
    fagr <- which(growth_nsc_data.10yr$GenusSpecies.x == "Fagus grandifolia")
  lm.fagr <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[fagr,])
  summary(lm.fagr)   #significant
  
  fram <- which(growth_nsc_data.10yr$GenusSpecies.x == "Fraxinus americana")
  lm.fram <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[fram,])
  summary(lm.fram)   #significant
  
  frni <- which(growth_nsc_data.10yr$GenusSpecies.x == "Fraxinus nigra")
  lm.frni <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[frni,])
  summary(lm.frni)
  
  juvi <- which(growth_nsc_data.10yr$GenusSpecies.x == "Juniperus virginiana")
  lm.juvi <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[juvi,])
  summary(lm.juvi)
  
    litu <- which(growth_nsc_data.10yr$GenusSpecies.x == "Liriodendron tulipifera")
  lm.litu <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[litu,])
  summary(lm.litu)
  
  mavi <- which(growth_nsc_data.10yr$GenusSpecies.x == "Magnolia virginiana")
  lm.mavi <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[mavi,])
  summary(lm.mavi)
  
  ##need to remove, only 2 points##
  nysy <- which(growth_nsc_data.10yr$GenusSpecies.x == "Nyssa sylvatica")
  lm.nysy <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[nysy,])
  summary(lm.nysy)
  
  oxar <- which(growth_nsc_data.10yr$GenusSpecies.x == "Oxydendrum arboreum")
  lm.oxar <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[oxar,])
  summary(lm.oxar)
  
  pima <- which(growth_nsc_data.10yr$GenusSpecies.x == "Picea mariana")
  lm.pima <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[pima,])
  summary(lm.pima)
  
  piru <- which(growth_nsc_data.10yr$GenusSpecies.x == "Picea rubens")
  lm.piru <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[piru,])
  summary(lm.piru)
  
  pipa <- which(growth_nsc_data.10yr$GenusSpecies.x == "Pinus palustris")
  lm.pipa <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[pipa,])
  summary(lm.pipa)
  
  pist <- which(growth_nsc_data.10yr$GenusSpecies.x == "Pinus strobus")
  lm.pist <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[pist,])
  summary(lm.pist)   #significant
  
  pita <- which(growth_nsc_data.10yr$GenusSpecies.x == "Pinus taeda")
  lm.pita <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[pita,])
  summary(lm.pita)
  
  pogr <- which(growth_nsc_data.10yr$GenusSpecies.x == "Populus grandidentata")
  lm.pogr <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[pogr,])
  summary(lm.pogr)
  
  potr <- which(growth_nsc_data.10yr$GenusSpecies.x == "Populus tremuloides")
  lm.potr <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[potr,])
  summary(lm.potr)   #significant
  
  prse <- which(growth_nsc_data.10yr$GenusSpecies.x == "Prunus serotina")
  lm.prse <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[prse,])
  summary(lm.prse)
  
  qual <- which(growth_nsc_data.10yr$GenusSpecies.x == "Quercus alba")
  lm.qual <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[qual,])
  summary(lm.qual)   #significant
  
  qula <- which(growth_nsc_data.10yr$GenusSpecies.x == "Quercus laevis")
  lm.qula <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[qula,])
  summary(lm.qula)
  
  qulau <- which(growth_nsc_data.10yr$GenusSpecies.x == "Quercus laurifolia")
  lm.qulau <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[qulau,])
  summary(lm.qulau)
  
    qumo <- which(growth_nsc_data.10yr$GenusSpecies.x == "Quercus montana")
  lm.qumo <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[qumo,])
  summary(lm.qumo)
  
 qumu <- which(growth_nsc_data.10yr$GenusSpecies.x == "Quercus muehlenbergii")
  lm.qumu <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[qumu,])
  summary(lm.qumu)
  
   quni <- which(growth_nsc_data.10yr$GenusSpecies.x == "Quercus nigra")
  lm.quni <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[quni,])
  summary(lm.quni)
  
  quru <- which(growth_nsc_data.10yr$GenusSpecies.x == "Quercus rubra")
  lm.quru <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[quru,])
  summary(lm.quru)   #significant
  
  quve <- which(growth_nsc_data.10yr$GenusSpecies.x == "Quercus velutina")
  lm.quve <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[quve,])
  summary(lm.quve)  #marginal
  
  saal <- which(growth_nsc_data.10yr$GenusSpecies.x == "Sassafras albidum")
  lm.saal <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[saal,])
  summary(lm.saal) 
  
  tsca <- which(growth_nsc_data.10yr$GenusSpecies.x == "Tsuga canadensis")
  lm.tsca <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[tsca,])
  summary(lm.tsca) #significant
  
  ulam <- which(growth_nsc_data.10yr$GenusSpecies.x == "Ulmus americana")
  lm.ulam <- lm(total.nsc ~ mean.2010.2001, data = growth_nsc_data.10yr[ulam,])
  summary(lm.ulam) 
  
  #9 significant and 3 marginal species relationships
  #power analysis to determine why not significant
  #pwr.r.test(n = , r = , sig.level = , power = )
  #average r
  mean(0.1238,0.172,0.1127,0.2262,0.1233,0.106,0.2648,0.4815,0.02989)
  #0.1238
  
  pwr.f2.test(u = 1, v = 104, f = (.03/.97), sig.level = .05)
  
  pwr.r.test(r = 0.12, sig.level = 0.05, power = 0.9)

n = 3:300
pow = rep(NA,length(n))
for(i in n){
  pow[i-2] <- pwr.f2.test(1,i-2,(.10/.9),0.05)$power
}
plot(n,pow)
abline(h=0.9)
thresh=n[which(pow>0.9)[1]]
abline(v=thresh)
thresh
  
  #Canopy lm
  canopy.lm <- lm(total.nsc ~ mean.2010.2001 + as.factor(CANOPY15) + as.factor(CANOPY15)*mean.2010.2001, data = growth_nsc_data.10yr)
  summary(canopy.lm)
  
  #Canopy Plot
  growth.nsc.canopy.plot <- ggplot(growth_nsc_data.10yr, aes(x = mean.2010.2001, y = total.nsc)) +
  geom_point(alpha = .1) +
  ylim(0,125) +
  xlim(0,6) +
  ylab(expression(paste("Total NSC mg g"^"-1"))) + xlab(expression(paste("2010-2001 Mean Ring Width mm yr"^"-1"))) +
  geom_smooth(method = "lm") + facet_wrap(~ CANOPY15, scales = "free")
  theme(axis.title.y = element_text(size = 12)) +
  theme(axis.title.x = element_text(size = 12))
  
  ggsave(filename = "/Users/josh/Dropbox/Dissertation/CH3_Growth_NSC/Growth_NSC_Canopy.png", plot = growth.nsc.canopy.plot, dpi = 600, width = 6, height = 3.5, units = "in")
  
  ###Subset data for only co-dominant canopy position trees
  ###to tease out effects
  co.dom <- which(growth_nsc_data.10yr$CANOPY15 == "1")
  co.dom.dat <- growth_nsc_data.10yr[co.dom,]
  
  co.dom.full.lm <- lm(total.nsc ~ mean.2010.2001 + succession + woodgroup + woodgroup*succession + mean.2010.2001*woodgroup + mean.2010.2001*succession + mean.2010.2001*woodgroup*succession + DBH14.x, data = co.dom.dat)
anova(co.dom.full.lm)
summary(co.dom.full.lm) ##All of the same terms as the full data set are significant

  
  #Site Differences
  #organizing by temperature as with other chapters
  growth_nsc_data.10yr$SITE <- factor(growth_nsc_data.10yr$SITE, levels = c("W","B","H","V","S","M","D","T","F"), ordered = TRUE)
  
  #Site lm
  site.lm <- lm(total.nsc ~ mean.2010.2001 + SITE + SITE*mean.2010.2001, data = growth_nsc_data.10yr)
summary(site.lm)
  
  #3d scatterplot with DBH
  scatterplot3d(x = growth_nsc_data.10yr$mean.2010.2001, y = growth_nsc_data.10yr$total.nsc, z = growth_nsc_data.10yr$DBH14.x, pch = ".")
  
  hist(growth_nsc_data.10yr$DBH15.x,breaks=35)

  #DBH indicator variables for bins of small, medium, large trees
  #roughly balanced - report numbers
  small.dbh <- which(growth_nsc_data.10yr$DBH15.x <= 20)
  med.dbh <- which(growth_nsc_data.10yr$DBH15.x > 20 & growth_nsc_data.10yr$DBH15.x <= 30)
  large.dbh <- which(growth_nsc_data.10yr$DBH15.x > 30)
  
  growth_nsc_data.10yr$dbh.group <- NA
  growth_nsc_data.10yr$dbh.group[small.dbh] <- "small"
  growth_nsc_data.10yr$dbh.group[med.dbh] <- "medium"
  growth_nsc_data.10yr$dbh.group[large.dbh] <- "large"
  
  growth.nsc.dbh.group.plot <- ggplot(growth_nsc_data.10yr[!is.na(growth_nsc_data.10yr$dbh.group),], aes(x = mean.2010.2001, y = total.nsc), na.rm = TRUE) +
  geom_point(alpha = .1) +
  ylim(0,125) +
  #xlim(0,6) +
  ylab(expression(paste("Total NSC mg g"^"-1"))) + xlab(expression(paste("2010-2001 Mean Ring Width mm yr"^"-1"))) +
  geom_smooth(method = "lm") + facet_wrap(~ dbh.group)
  theme(axis.title.y = element_text(size = 12)) +
  theme(axis.title.x = element_text(size = 12))
  
    ggsave(filename = "/Users/josh/Dropbox/Dissertation/CH3_Growth_NSC/Growth_NSC_DBH.png", plot = growth.nsc.dbh.group.plot, dpi = 600, width = 6, height = 3.5, units = "in")
    
    #DBH lm
    dbh.lm <- lm(total.nsc ~ mean.2010.2001 + DBH14.y + mean.2010.2001*DBH14.y, data = growth_nsc_data.10yr)
    summary(dbh.lm)
    
    #DBH binned lm with interaction included
    dbh.bin.int.lm <- lm(total.nsc ~ mean.2010.2001 + dbh.group + mean.2010.2001*dbh.group, data = growth_nsc_data.10yr)
    summary(dbh.bin.int.lm)
    predict(dbh.bin.int.lm)
    
    #plot of different intercepts for DBH categories
    #doesn't include 1 point with ring width around 8
    #need to get point and either put on graph and/or in legend
    dbh.int.ggplot <- ggplot(data=growth_nsc_data.10yr, mapping = aes(x = mean.2010.2001, y = total.nsc, color = dbh.group)) + 
      geom_point() + 
      xlim(0,6) + 
      scale_color_manual(values=cbPalette) + 
      geom_abline(intercept = 56.381, slope = 3.632, col = "#999999") +
      geom_abline(intercept = 49.48, slope = 3.632, col = "#E69F00") +
      geom_abline(intercept = 40.893, slope = 3.632, col = "#56B4E9") +
      ylab(expression(paste("Total NSC mg g"^"-1"))) +
      xlab(expression(paste("2010-2001 Mean Ring Width mm yr"^"-1"))) +
      labs(color = "DBH")
 
        ggsave(filename = "/Users/josh/Dropbox/Dissertation/CH3_Growth_NSC/Growth_DBH_int.png", plot = dbh.int.ggplot, dpi = 600, width = 5, height = 3.5, units = "in")   

  
```
## Including Plots

```{r}
###Mortality Analysis
###These cores are only Alive or Stressed, need to use
###NSC_Analysis.Rmd for Mortality analysis
lm.mortality <- lm(total.nsc ~ Mortality14, data = growth_nsc_data.10yr)
anova(lm.mortality)
summary(lm.mortality)

mortality.boxplot <- ggplot(growth_nsc_data.10yr, aes(x = Mortality14, y = total.nsc)) +
  geom_boxplot() + theme(axis.text.x = element_text(angle=45,hjust=1,size=16)) +
  theme(axis.text.y = element_text(size=16)) +
  theme(axis.title.x = element_text(size=20)) +
  theme(axis.title.y = element_text(size=20)) +
  theme(legend.text = element_text(size=16)) +
  stat_summary(fun.data = give.n, geom= "text", aes(y= 160)) + 
  ylab(expression(paste("Total NSC mg g"^"-1"))) + xlab("Mortality Status") + ggtitle("All Mortality Statuses") +
  scale_fill_manual(values=rev(cbPalette))



```
You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
